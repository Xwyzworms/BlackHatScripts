import optparse
from socket import *





def connectScan(tgtHost, tgtPort):
    try:
        connectSocket = socket(AF_INET, tgtPort)
        connectSocket.connect((tgtHost, tgtPort))
        print(f"[+] TCP Open {tgtPort}")
        connectSocket.close()
    except:
        print(f"[-] TCP Closed {tgtPort}")


def scanPort(tgtHost, tgtPorts):
    
    try:
        targetIP = gethostbyname(tgtHost)
    except:
        print(f"[-] Cannot Resolve {tgtHost} Unknown Host")

    try:
        targetName = gethostbyaddr(targetIP)
        print(f"[+] Scan Results for :  {targetName[0]}")
    except:
        print(f"[+] Scan Results for {targetIP}")

    setdefaulttimeout()
    for targetPort in tgtPorts:
        print(f"Scanning Port {targetPort} ")
        connectScan(tgtHost, targetPort)

parser = optparse.OptionParser("usage %prog -H <target host> -p <target port>")

parser.add_option("-H", dest="tgtHost", type="string", help="Specify Target Host")
parser.add_option("-p", dest="tgtPort", type="int", help="Specify Target Port")

(options, args) = parser.parse_args()

tgtHost = options.tgtHost
tgtPort = options.tgtPort

if(tgtHost == None) | (tgtPort == None) :
    print(parser.usage)
    exit(0)



